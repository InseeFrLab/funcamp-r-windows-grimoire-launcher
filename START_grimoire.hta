<html>
 <head>

<HTA:APPLICATION ID="icaRius-0.9"
  APPLICATIONNAME="icaRius - Accueil pedagogique"
  BORDER="none"
  BORDERSTYLE="normal"
  CAPTION="yes"
  CONTEXTMENU="yes"
  ICON="ressources/Grimoire/accueil/icon.bmp"
  INNERBORDER="yes"
  MAXIMIZEBUTTON="yes"
  MINIMIZEBUTTON="yes"
  NAVIGABLE="yes"
  SCROLL="yes"
  SCROLLFLAT="no"
  SELECTION="yes"
  SHOWINTASKBAR="yes"
  SINGLEINSTANCE="yes"
  SYSMENU="yes"
  VERSION="1.0"
  WINDOWSTATE="maximize" />


<script type="text/vbscript">

' Declare global variable outside the Subs
Dim intSeconds
Dim OnlyOnce
Dim iTimerID
Dim spanID
Dim drive
Dim objCurrDir 
  
'############################################################################### 
'# Name: Window_OnLoad 
'# Purpose: Functions to execute at load time. 
'############################################################################### 
Sub Window_OnLoad 
   SetCurrDir() 
End Sub 
 
'############################################################################### 
'# Name: Report 
'# Purpose: Report own location. 
'############################################################################### 
Sub Report() 
   MsgBox "Script's parent folder: " & VbNewLine & VbNewLine & objCurrDir & "ressources\R\bin\Rscript.exe"
End Sub 
 
'############################################################################### 
'# Name: EndApp 
'# Purpose: Exit HTA application. 
'############################################################################### 
Sub EndApp() 
   self.Close() 
End Sub 
 
'############################################################################### 
'# Name: SetCurrDir 
'# Purpose: Capture and set def to folder where this HTA exists. 
'############################################################################### 
Sub SetCurrDir() 
   Set objFSO = CreateObject("Scripting.FileSystemObject") 
   Set WshShell = CreateObject("WScript.Shell") 
   '### document.location.href always returns the HTML rendering of own fully-qualified 
   '### location: "file:///" followed by fully-qualified path to curr file, but elements   
   '### are separated by FORWARD slashes and spaces are rendered as "%20". 
   '### Capture it, strip off leading data, replace slashes and escape sequences. 
   strHtmlLocnVal = document.location.href 
   strThisHTA = Replace(Right(strHtmlLocnVal, Len(strHtmlLocnVal) - 8), "/", "\") 
   strThisHTA = UnEscape(strThisHTA) 
   '### Bind FSO to the file and capture parent directory. 
   Set objThisFile = objFSO.GetFile(strThisHTA) 
   objParentDir = objThisFile.ParentFolder 
   Set objFolder = objFSO.GetFolder(objParentDir) 
   '### To preclude problems with folder names that contain spaces, e.g. 
   '### "Documents and Settings" or "Program Files", return the 8.3 name. 
   objCurrDir = objFolder.ShortPath 
   WshShell.CurrentDirectory = objCurrDir 
End Sub 

'############################################################################### 
'# DEPRECATED 
'# Name: GetDriveLetter
'# Purpose: Capture and set path to USB Key with name being label variable
'###############################################################################
Function GetDriveLetter (label)
	GetDriveLetter = ""
        'DriveType is one of                        '
        '   0 = Unknown            3 = Network      '
        '   1 = Removable          4 = CD-ROM       '
        '   2 = Fixed              5 = RAM Disk     '
 
        For Each drive In CreateObject("Scripting.FileSystemObject").Drives
            If drive.IsReady Then
                If drive.DriveType = 1 And drive.VolumeName = label Then
                    GetDriveLetter = drive.DriveLetter
                    Exit Function
                End If
            End If
        Next
		
End Function

'############################################################################### 
'# Name: countdown_launch
'# Purpose: Create a countdown starting with theNumber value
'###############################################################################
Sub countdown_launch(theNumber)
      intSeconds = 0
      OnlyOnce = 0
      iTimerID = window.setInterval("TimerRefresh", 1000)
      spanID = "span_clock_" & theNumber
End Sub

Sub TimerRefresh

      If OnlyOnce = 0 Then
            msgbox "Dmarrage en cours. Merci de patienter quelques secondes..."
            intSeconds = 30
	    OnlyOnce = 1
      Else
	If IntSeconds > 0 Then
        	intSeconds = intSeconds - 1
		document.getElementById(spanID).innerHTML = "Le tutoriel se lance et sera disponible d'ici environ : " & Right("00" & intSeconds, 2) & " secondes"
	Else
		IntSeconds = 0
		window.clearInterval(iTimerID)
		document.getElementById(spanID).innerHTML = "tutoriel excut"
	End If

      End If
      
End Sub

sub enigme(theNumber)

	Call countdown_launch(theNumber)

	Dim oShell : Set oShell = CreateObject("WScript.Shell")
	' Kill previous Rscript.exe '
	oShell.Run "taskkill /im Rscript.exe", , True
	
	Rexe           = objCurrDir & "ressources\R\bin\Rscript.exe"
	Ropts          = "--no-save --no-environ --no-init-file --no-restore --no-Rconsole"
	RScriptFile    = objCurrDir & "ressources/Grimoire\launch_chapitre.R"
	Outfile        = objCurrDir & "ressources/Grimoire\launch_chapitre" & theNumber & ".log" 
	strCommand     = Rexe & " " & Ropts & " " & RScriptFile & " " & theNumber & " 1> " & Outfile & " 2>&1"
	intWindowStyle = 0     ' Hide the window and activate another window.'
	bWaitOnReturn  = False ' continue running script after launching R   

	' Run new Rscript.exe with related R program'
	Set wshShell = CreateObject("WScript.Shell")
    	WshShell.Run strCommand, intWindowStyle, bWaitOnRetur

end sub
  
</script>

 <title>Funcamp R</title>
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html">
 <style>
  body
  {
   background-color:white;
  }
   
  #titre
  {
   width:100vw;
   text-align:center;
   color:#067790;
   font-family:calibri,arial;
  }
 
p  {
   text-align:center;
   font-family:calibri,arial;
  }

#outer-div {
  width: 100%; 
  text-align: center;
}

#inner-div {
  display: inline-block; 
  text-align:left;
  background-color: white;
  border: 1px solid black;
  padding: 25px;
  margin: 25px auto;
  width: 1100px;
  font-family:calibri,arial;
}

span.b {
  display: inline-block;
  width: 300px;
  height: 300px;
  padding: 5px;
  margin: 20px;
  border: 1px solid black;    
  background-color: white; 
}

</style>
</head>
<body>
<div id ="outer-div" width="100%">
<div id ="inner-div">
<p><img src="ressources/Grimoire/accueil/Funcamp-Frise.png"> <h1 id='titre'>Funcamp R - Accueil</h1></p>
<br>
Soyez le/la bienvenu(e) au Funcamp R. Cette page rassemble les supports pdagogiques relatifs  la formation  laquelle vous prendrez part pendant la journe. Pardon : cette page ouvre le grimoire IGoR, qui vous accompagnera dans lpope statistico-ludique dont vous tes le hros / lhrone. Vous y trouverez, distille au fur et  mesure des chapitres enlumins, toute la sagesse accumule par ces mages qui, dans lombre, ont imagin les preuves que vous aurez  franchir.<br>
<br>
Parcourir ce grimoire vous permettra dapprendre, pas  pas, le langage des Runes, ncessaire pour aider le jeune icaRius, votre alter-ego numrique,  sauver le royaume de Statis de la menace qui le guette. Au cours de cette aventure, il vous sera ainsi demand de rsoudre des nigmes, dont la solution vous permettra davancer un peu plus loin dans les terres de Statis. Ces nigmes sont autant dtapes pour dcouvrir les possibilits (magiques!) offertes par R. La solution sera ensuite  renseigner dans lcran du jeu icaRius, prvu  cet effet.<br>
<br>
<p><img src="ressources/Grimoire/accueil/grimoire.png"></p><br>
Au fait, il est bientt temps de dmarrer votre partie dIcaRius. Pour cela, dans quelques instants, vous double-cliquerez sur licone icaRius <b>dans le rpertoire de la cl USB ddie au jeu vido.</b><br>
<br>
Au fur et  mesure de votre aventure, vous aurez  rsoudre des nigmes, poses par les personnages que vous croiserez au cours de votre qute. A chaque nigme correspond un tutoriel d'apprentissage en R. Pour lancer le tutoriel correspondant, il vous faudra cliquer, <b>en bas de cette page</b>, sur le bouton correspondant : chaque tutoriel est numrot pour bien s'y retrouver.<br> 
<br>
Au bout de quelques minutes de jeu, vous rencontrerez ainsi le Mage RegoR, qui vous proposera de rsoudre une premire nigme. Voici la question pose : quel est lge dicaRius ?. Le premier tutoriel R de cette aventure vous apportera la rponse. Une fois trouve, il faudra la reporter dans le jeu icaRius, dans l'cran bleu, pour dbloquer la suite de l'histoire. 
<br>
<p><img src="ressources/Grimoire/accueil/icaRius_premiers_pas.png"></p><br>
<br>
<b><i>Vous tes prt(e)s ? Lancer donc le jeu icaRius puis, le moment venu, activez depuis cette page chaque tutoriel correspondant  votre nigme via les panneaux ci-dessous. </i></b>

<p>
<span class="b"> 
<b>Enigme 1</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme01.png"><br>
<br>
Vous venez de rencontrer le mage RegoR, dans la maison d'icaRius.<br>
<br>
<input type="button" name="launch_enigme_1" Value="Lancez le tutoriel" onClick="enigme 1"><br>
<br>
<span id="span_clock_1"> * <BR> *  * </span>
<br>
</span> 

<span class="b"> 
<b>Enigme 2</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme02.png"><br>
<br>
Des poules en or ? Aidez la fermire  compter les pontes...<br>
<br>
<input type="button" name="launch_enigme_2" Value="Lancez le tutoriel" onClick="enigme 2"><br>
<br>
<span id="span_clock_2"> * <BR> *  * </span>
<br>
</span> 

<span class="b"> 
<b>Enigme 3</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme03.png"><br>
<br>
Le chef du village de GrissGrass vous demande de trouver le meilleur exploitant.<br>
<br>
<input type="button" name="launch_enigme_3" Value="Lancez le tutoriel" onClick="enigme 3"><br>
<br>
<span id="span_clock_3"> * <BR> *  * </span>
<br>
</span> 

</p>

<p>

<span class="b"> 
<b>Enigme 4</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme04.png"><br>
<br>
Dcouvrez le secret de la culture de la Mandragore !<br>
<br>
<input type="button" name="launch_enigme_4" Value="Lancez le tutoriel" onClick="enigme 4"><br>
<br>
<span id="span_clock_4"> * <BR> *  * </span>
<br>
</span> 

<span class="b"> 
<b>Enigme 5</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme05.png"><br>
<br>
Dans le chteau de Statis, le cuistot Batreb vous parle d'ivresse...<br>
<br>
<input type="button" name="launch_enigme_5" Value="Lancez le tutoriel" onClick="enigme 5"><br>
<br>
<span id="span_clock_5"> * <BR> *  * </span>
<br>
</span> 

<span class="b"> 
<b>Enigme 6</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme06.png"><br>
<br>
Fabriquez une fake news avec l'aide du mage Essespus !<br>
<br>
<input type="button" name="launch_enigme_6" Value="Lancez le tutoriel" onClick="enigme 6"><br>
<br>
<span id="span_clock_6"> * <BR> *  * </span>
<br>
</span> 

</p>

<p>
<span class="b"> 
<b>Enigme 7 (optionnelle)</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme07.png"><br>
<br>
Vous voici  l'entre du labyrinthe, avec le mage Delagarde...<br>
<br>
<input type="button" name="launch_enigme_7" Value="Lancez le tutoriel" onClick="enigme 7"><br>
<br>
<span id="span_clock_7"> * <BR> *  * </span>
<br>
</span> 

<span class="b"> 
<b>Enigme 8</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme08.png"><br>
<br>
Nouvelle rencontre avec le mage Zilap, pour librer le passage...<br>
<br>
<input type="button" name="launch_enigme_8" Value="Lancez le tutoriel" onClick="enigme 8"><br>
<br>
<span id="span_clock_8"> * <BR> *  * </span>
<br>
</span> 

<span class="b"> 
<b>Enigme 9</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme09.png"><br>
<br>
Dans le village de Sandia, Mam'Grouxi vous parle des enfants de Statia.<br>
<br>
<input type="button" name="launch_enigme_9" Value="Lancez le tutoriel" onClick="enigme 9"><br>
<br>
<span id="span_clock_9"> * <BR> *  * </span>
<br>
</span> 

</p>

<p>
<span class="b"> 
<b>Enigme 10</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme10.png"><br>
<br>
Save Me. IcaRius se trouve bloqu dans la salle de l'impossible...<br>
<br>
<input type="button" name="launch_enigme_10" Value="Lancez le tutoriel" onClick="enigme 10"><br>
<br>
<span id="span_clock_10"> * <BR> *  * </span>
<br>
</span> 

<span class="b"> 
<b>Enigme 11</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme11.png"><br>
<br>
Codez-le une fois. L'automate TeoC enseigne  icaRius la Voie du Reproductible<br>
<br>
<input type="button" name="launch_enigme_11" Value="Lancez le tutoriel" onClick="enigme 11"><br>
<br>
<span id="span_clock_11"> * <BR> *  * </span>
<br>
</span> 

<span class="b"> 
<b>Enigme 12</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme12.png"><br>
<br>
De loxygne documentaire. Rencontre d'un drle doiseau, au bord du Datalake...<br>
<br>
<input type="button" name="launch_enigme_12" Value="Lancez le tutoriel" onClick="enigme 12"><br>
<br>
<span id="span_clock_12"> * <BR> *  * </span>
<br>
</span> 

</p>

<p>
<span class="b"> 
<b>Enigme 13</b> <br>
<br>
<img src="ressources/Grimoire/accueil/enigme13.png"><br>
<br>
 l'histoire sans fin. La gueRnouille Asa apprend  icaRius comment crire la fin de l'histoire...<br>
<br>
<input type="button" name="launch_enigme_13" Value="Lancez le tutoriel" onClick="enigme 13"><br>
<br>
<span id="span_clock_13"> * <BR> *  * </span>
<br>
</span> 

</p>

<br>
<INPUT ID="LocnBtn" CLASS="BUTTON" TYPE="BUTTON" VALUE="Test du chemin" OnClick="Report()">
<br>
<br>
<INPUT ID="ExitBtn" CLASS="BUTTON" TYPE="BUTTON" VALUE="Fermer cette page" OnClick="EndApp()"> 
<br>
<br>
</div>
</div>

 </body>
</html>